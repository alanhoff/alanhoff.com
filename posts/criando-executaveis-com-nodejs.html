<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Blog pessoal sobre JavaScript, Node.js, AngularJs, sistemas embarcados e outras cachaças.">
  <meta name="author" content="Alan Hoffmeister <alanhoffmeister@gmail.com>">

  <title>Alan Hoffmeister - Criando executáveis com Node.js</title>

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://alanhoff.com/rss.xml">

  <!-- Fonts -->
  <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet">
  <link href="//fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">

  <!-- Bootstrap core CSS -->
  <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/css/font-awesome.min.css" rel="stylesheet">
  <link href="/assets/css/bootstrap-social.css" rel="stylesheet">

  <!-- Styles -->
  <link href="/assets/css/main.css" rel="stylesheet">
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/monokai_sublime.min.css">
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
  <script type="text/javascript" src="//blockchain.info/Resources/wallet/pay-now-button.js"></script>


</head>


  <body>

    <div id="primary" class="col-sm-12">
      <div class="content">
      <a href="https://github.com/alanhoff/alanhoff.com"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>

        <header class="header">
          <hgroup class="pull-left">
            <h1 class="site-title">
              
              <a rel="home" title="Alan Hoffmeister" href="/">
                <i class="fa fa-newspaper-o"></i> Alan Hoffmeister
              </a>
              
            </h1>
          </hgroup>
          <a href="https://alanhoff.com/rss.xml" class="btn btn-primary pull-right">
            <i class="fa fa-rss"></i>
          </a>
        </header> <!-- /header -->

        

  
  <img src="/assets/img/posts/nodejs.jpg" class="img-responsive">
  
  <section class="post">
    <header class="entry-header">
      <img class="entry-avatar" alt="Paul Laros" height="52" width="52" src="//www.gravatar.com/avatar/6350d3781efe9d1a3a88542771ee39d4.jpg?s=52">
      <h1 class="entry-title"><a href="posts/criando-executaveis-com-nodejs.html">Criando executáveis com Node.js</a></h1>
      <p class="entry-meta">
        Postado em 2015-01-12 14:29 | Por <a class="entry-author" href="https://twitter.com/alan_hoff">Alan Hoffmeister</a>
      </p>
    </header>
    <div class="entry-description">
        <p>Quem nunca teve a vontade de criar um executável para distribuir em outras
máquinas e clientes, usando o Node.js? Hoje vamos falar um pouco sobre como
criar um arquivo único contendo o seu código junto com o Node.js.
<!--more--></p>
<p>Dica simples e rápida para quem deseja criar aquele <code>arquivo.exe</code> ou executar um
<code>./hello-world</code> no terminar sem precisar instalar o Node.js.</p>
<p>A distribuição do Node.js já vem pré configurada para ser distribuída juntamente
com arquivos de terceiros, assim você pode integrar o seu script juntamente com
o build do Node.js.</p>
<h3 id="instru-es-para-linux">Instruções para linux</h3>
<p>O primeiro passo é instalar as dependências e baixar o source code do Node.js
para que possamos compilá-lo.</p>
<pre><code class="lang-bash">sudo apt-get install build-essential
curl -O http://nodejs.org/dist/v0.10.35/node-v0.10.35.tar.gz
tar -zxvf node-v0.10.35.tar.gz
cd node-v0.10.35
</code></pre>
<p>Feito isso, precisamos criar um arquivo chamado <code>_third_party_main.js</code> e
adicionar este arquivo ao <code>node.gyp</code>, depois disto é só compilar.</p>
<pre><code class="lang-bash"># Criamos o arquivo necessário
echo &#39;console.log(&quot;Hello world!&quot;);&#39; &gt;&gt; lib/_third_party_main.js

# Depois acrescentamos este arquivo nas dependências da build
sed -i &quot;s/lib\/zlib.js&#39;,/lib\/zlib.js&#39;,\n&#39;lib\/_third_party_main.js&#39;/&quot; node.gyp

# Agora é só compilar o Node.js!
./configure
make
</code></pre>
<p>Após a compilação seu binário estará localizado na pasta <code>./out/Release</code> e você
já pode rodar ele.</p>
<pre><code class="lang-bash">cd ./out/Release
./node
</code></pre>
<p>Agora é só enviar este executável para os seus amigos, o seu programa rodará
sem precisar instalar o Node.js.</p>
<h3 id="instru-es-para-windows">Instruções para Windows</h3>
<p>Se alguém souber o processo de compilação para Windows, por favor
<a href="https://github.com/alanhoff/alanhoff.com/tree/master/content/posts">forke esta postagem</a> e adicione aqui.</p>
<h3 id="b-nus-reduzindo-o-tamanho-com-o-upx">Bônus: reduzindo o tamanho com o UPX</h3>
<p>O <a href="http://upx.sourceforge.net/">UPX</a> é um packer para executáveis, reduzindo o tamanho dos mesmo, podemos
utilizar ele para reduzir o tamanho do executável gerado.</p>
<pre><code class="lang-bash">sudo apt-get install upx
cd ./out/Release
cp node node_compressed
upx node_compressed
</code></pre>
<p>Podemos ver que o resultado ficou muito bom, nosso executável passou de 12Mb
para apenas 4Mb, e continua funcionando.</p>
<pre><code>➜  Release ls -lah
total 43M
-rwxrwxr-x  1 alan alan  12M Jan 12 15:31 node*
-rwxrwxr-x  1 alan alan 4,1M Jan 12 15:36 node_compressed*
</code></pre>
        <br />
        <div style="font-size:16px;margin:0 auto;width:300px" class="blockchain-btn"
         data-address="1EnNVggZnjsEeDbxAfVa2mqVjnFbUwB4Y7"
         data-shared="false">
        <div class="blockchain stage-begin">
            <img src="https://blockchain.info/Resources/buttons/donate_64.png"/>
        </div>
        <div class="blockchain stage-loading" style="text-align:center">
            <img src="https://blockchain.info/Resources/loading-large.gif"/>
        </div>
        <div class="blockchain stage-ready">
             <p align="center">Por favor envie a doação para: <b>[[address]]</b></p>
             <p align="center" class="qr-code"></p>
        </div>
        <div class="blockchain stage-paid">
             Doação de <b>[[value]] BTC</b> recebida. Obrigado!
        </div>
        <div class="blockchain stage-error">
            <font color="red">[[error]]</font>
        </div>
    </div>
    </div>
  </section>

  <div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'alanhoffmeister'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
  </div>


        <footer class="footer">
          <p>Conteúdo sob <a href="https://pt.wikipedia.org/wiki/Licen%C3%A7a_ISC">licença ISC</a>. 2014 - Alan Hofmeister</p>
          <div class="socials-footer">
            <a class="btn btn-facebook" href="https://www.facebook.com/alan.hoffmeister" title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
            <a class="btn btn-twitter" href="https://twitter.com/alan_hoff" title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
            <a class="btn btn-linkedin" href="http://br.linkedin.com/in/alanhoff" title="LinkedIn">
              <i class="fa fa-linkedin"></i>
            </a>
            <a class="btn btn-google-plus" href="https://plus.google.com/+alanhoffmeister" title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
            <a class="btn btn-github" href="https://github.com/alanhoff" title="GitHub">
              <i class="fa fa-github"></i>
            </a>
            <a class="btn btn-bitbucket" href="https://bitbucket.org/alanhoff" title="Bitbucket">
              <i class="fa fa-bitbucket"></i>
            </a>
          </div> <!-- /.socials-footer -->
        </footer> <!-- /footer -->

      </div>
    </div> <!-- /#primary -->

    <!-- Scripts -->
    <script src="/assets/js/jquery-1.11.0.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script type="text/javascript">
  $('code').each(function(){
    var el = $(this);
    var content = el.text();
    var lang = el.attr('class') || '';
    lang = lang.indexOf('lang-') === 0 ? lang.substring(5) : 'html';
    el.html(hljs.highlight(lang, content).value);
  });
</script>


  </body>
</html>
